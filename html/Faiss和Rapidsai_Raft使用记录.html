<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="zh-CN" xml:lang="zh-CN" data-theme="tufte">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="description" content="Faisså’ŒRapidsai_Raftä½¿ç”¨è®°å½•" />
  <meta name="keywords" content="faiss, rapidsai, raft, cagra, vector search" />
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="/extra/classless.css" />
  <script>
      let search = () => {
          let word = document.querySelector('input');
          if (word.value.length == 0) {
              word.focus();
          } else {
              location.href = '/search.html?' + word.value;
          }
      };
      window.onload = () => {
          document.querySelector('input').addEventListener(
              'keydown',  (event) => {
                  if (event.key == 'Enter') search();
          });
      }
  </script>
  <link rel="icon" href="/img/favicon.ico" type="image/x-icon" />
  <link rel="shortcut icon" href="/img/favicon.ico" type="image/x-icon" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@callmebill/lxgw-wenkai-web@latest/lxgwwenkai-regular/result.css?v=1" />
  <title>Faisså’ŒRapidsai_Raftä½¿ç”¨è®°å½•</title>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
    <nav>
        <ul>
            <li><big>VnYzmçš„åšå®¢</big></li>
            <li><a href="/index.html">æ‰€æœ‰æ–‡ç« </a> â–¾
                <ul>
                    <li><a href="/technique.html">æŠ€æœ¯</a></li>
                    <li><a href="/miscellany.html">æ‚è°ˆ</a></li>
                    <li><a href="/share.html">åˆ†äº«</a></li>
                </ul>
            </li>
            <li><a href="/friends.html">å‹é“¾</a></li>
            <li><a href="/html/å…³äº.html">å…³äº</a></li>
            <li><a href="https://www.travellings.cn/go.html" target="_blank">å¼€å¾€</a></li>
            <li><a href="/extra/atom.xml">RSS</a></li>
            <li class="float-right">
              <div style="position: relative; display: inline-block;">
                <input type="search" placeholder="æœç´¢æ ‡é¢˜" style="margin: 0; padding-right: 2em;">
                <button style="position: absolute; right: 0; top: 50%; transform: translateY(-50%); border: none; background: transparent; margin: 0;" onclick="search()">
                  <svg width="1em" height="1em" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <path d="M15.7955 15.8111L21 21M18 10.5C18 14.6421 14.6421 18 10.5 18C6.35786 18 3 14.6421 3 10.5C3 6.35786 6.35786 3 10.5 3C14.6421 3 18 6.35786 18 10.5Z" stroke="#000000" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path> </g></svg>
                </button>
              </div>
            </li>
        </ul>
    </nav>
<header id="title-block-header">
<h1 class="title">Faisså’ŒRapidsai_Raftä½¿ç”¨è®°å½•</h1>
<hr>
</header>
<h3 id="èƒŒæ™¯">èƒŒæ™¯</h3>
<p>æœ€è¿‘åœ¨åšåŸºäºå›¾çš„è¿‘ä¼¼å‘é‡æ£€ç´¢çš„å®éªŒï¼Œéœ€è¦ç”¨åˆ°<a href="https://github.com/facebookresearch/faiss">Faiss</a>åº“å’ŒRapidsç³»åˆ—çš„<a href="https://github.com/rapidsai/raft">Raft</a>åº“ï¼ŒåŒæ—¶ç”±äºè¦ç»Ÿè®¡ä¸€äº›ç®—æ³•å†…éƒ¨çš„æ•°æ®ï¼Œå› æ­¤ä¸èƒ½ç›´æ¥ä½¿ç”¨å®ƒä»¬é¢„ç¼–è¯‘çš„Pythonåº“ï¼Œè€Œè¦æ‰‹åŠ¨ä»æºç ç¼–è¯‘å¹¶é€šè¿‡C++è°ƒç”¨ï¼Œè¿™é‡Œè®°å½•ä¸€ä¸‹ç¼–è¯‘è¿è¡Œæ—¶é‡åˆ°çš„ä¸€äº›é—®é¢˜å’ŒæŠ€å·§ï¼Œå…¶ä¸­Raftçš„å‘å°¤å…¶å¤šã€‚</p>
<h3 id="faiss">Faiss</h3>
<h4 id="ç¼–è¯‘">ç¼–è¯‘</h4>
<p>Faissåº“ç¼–è¯‘æ¯”è¾ƒç®€å•ï¼ŒæŒ‰ç…§å®˜ç½‘çš„æ•™ç¨‹å³å¯ã€‚ä¸è¿‡ä½¿ç”¨é»˜è®¤cmakeå¼€å…³ç¼–è¯‘å‡ºæ¥çš„æ•ˆç‡æ¯”è¾ƒä½ï¼Œå¦‚æœè¦å’Œé¢„ç¼–è¯‘çš„Pythonåº“å¯¹é½çš„è¯éœ€è¦æ‰‹åŠ¨æŒ‡å®šcmakeå¼€å…³ã€‚é¦–å…ˆéœ€è¦å®‰è£…Intelçš„çŸ©é˜µåº“MKLï¼ŒæŒ‰ç…§<a href="https://www.intel.cn/content/www/cn/zh/developer/tools/oneapi/base-toolkit-download.html">è¿™ä¸ªç½‘ç«™</a>çš„æ“ä½œæ¥å³å¯ï¼Œå› ä¸ºç³»ç»Ÿæ˜¯Ubuntuï¼Œæ‰€ä»¥æˆ‘é€‰æ‹©çš„æ˜¯APTå®‰è£…æ–¹å¼ï¼ŒæŒ‰ç…§ç½‘ç«™æ·»åŠ äº†æºç„¶å<code>apt install intel-oneapi-mkl-devel</code>ã€‚ç„¶åæˆ‘ä½¿ç”¨çš„cmakeå¼€å…³æ˜¯ï¼š</p>
<pre class="shell"><code>cmake -DFAISS_ENABLE_GPU=OFF -DFAISS_ENABLE_PYTHON=OFF -DBUILD_TESTING=OFF -DBUILD_SHARED_LIBS=OFF -DCMAKE_BUILD_TYPE=Release -DFAISS_OPT_LEVEL=avx512 -DBLA_VENDOR=Intel10_64_dyn -DMKL_LIBRARIES=/path/to/mkl/libs</code></pre>
<p>å‰å››ä¸ªå’Œæ•ˆç‡æ²¡ä»€ä¹ˆå…³ç³»ï¼Œçœ‹ä½ éœ€ä¸éœ€è¦ç¼–è¯‘GPUã€Pythonåº“ã€æµ‹è¯•ä»£ç å’ŒåŠ¨æ€åº“ã€‚<code>-DFAISS_OPT_LEVEL=avx512</code>ç”¨æ¥æŒ‡å®šè·ç¦»è®¡ç®—æ—¶ç”¨ä»€ä¹ˆçº§åˆ«çš„å‘é‡åŒ–æŒ‡ä»¤ï¼Œéœ€è¦æ ¹æ®ä½ çš„CPUæ¶æ„è€Œå®šï¼Œæˆ‘ç”¨çš„æœåŠ¡å™¨æ”¯æŒAVX512ï¼Œå¯ä»¥é€šè¿‡<code>cat /proc/cpuinfo</code>æŸ¥çœ‹ä½ çš„CPUæ”¯æŒæƒ…å†µï¼Œä¸€èˆ¬AVX2éƒ½æ˜¯æ”¯æŒçš„ï¼Œæ‰€ä»¥å¯ä»¥è®¾ç½®ä¸º`<code>-DFAISS_OPT_LEVEL=avx2</code>ã€‚ä¹‹åæ­£å¸¸makeå°±å¯ä»¥äº†ï¼Œæ²¡ä»€ä¹ˆå‘ã€‚</p>
<h4 id="ä½¿ç”¨">ä½¿ç”¨</h4>
<p>ä½¿ç”¨çš„æ—¶å€™ï¼Œä½¿ç”¨å¦‚ä¸‹çš„ç¼–è¯‘æŒ‡ä»¤ï¼š</p>
<pre class="shell"><code>g++ run.cpp -O3 \
-I ../faiss -L ../faiss/build/faiss -fopenmp -lfaiss_avx512 \
-m64  -lmkl_intel_lp64 -lmkl_gnu_thread -lmkl_core -lgomp -lpthread -lm -ldl \
-o run</code></pre>
<p>å…¶ä¸­ï¼Œ<code>-I</code>è·Ÿçš„æ˜¯faissæºç æ‰€åœ¨ç›®å½•ï¼Œ<code>-L</code>è·Ÿçš„æ˜¯ç¼–è¯‘å‡ºæ¥çš„<code>libfaiss.a</code>æ‰€åœ¨ç›®å½•ï¼Œå¦‚æœä½ å‰é¢make installäº†å°±ä¸ç”¨åŠ è¿™ä¸¤ä¸ªå‚æ•°ã€‚<code>-lfaiss_avx512</code>å’Œä¸Šé¢ç¼–è¯‘faissæ—¶çš„cmakeå¼€å…³æ˜¯å¯¹åº”çš„ï¼Œå¦‚æœé€‰æ‹©äº†AVX512ï¼Œè¿™é‡Œå°±å¯ä»¥é“¾æ¥<code>libfaiss_avx512.a</code>ï¼Œå¦‚æœé€‰æ‹©äº†AVX2ï¼Œåˆ™å¾—é“¾æ¥<code>libfaiss_avx2.a</code>ï¼Œå³ä½¿ç”¨å‚æ•°<code>-lfaiss_avx2</code>ã€‚å½“ç„¶ï¼Œä¸ç®¡é€‰æ‹©å“ªä¸ªcmakeå¼€å…³ï¼Œéƒ½ä¼šé»˜è®¤ç¼–è¯‘å‡ºä¸€ä¸ªæ²¡ç”¨AVXçš„ç‰ˆæœ¬<code>libfaiss.a</code>ï¼Œæ‰€ä»¥ä½¿ç”¨<code>-lfaiss</code>ä¹Ÿå¯ä»¥ï¼Œå°½ç®¡æ•ˆç‡ä¼šæ¯”è¾ƒä½ã€‚</p>
<p>ç¬¬ä¸‰è¡Œçš„æ˜¯Intel MKLçš„ç¼–è¯‘å‚æ•°ï¼Œä»¥ä¸Šåªæ˜¯æˆ‘ä¸ªäººçš„é€‰é¡¹ï¼Œå»ºè®®é€šè¿‡<a href="https://www.intel.com/content/www/us/en/developer/tools/oneapi/onemkl-link-line-advisor.html">è¿™ä¸ªç½‘ç«™</a>è‡ªåŠ¨ç”Ÿæˆã€‚æ³¨æ„ä¸¤ç‚¹ï¼Œä¸€ä¸ªæ˜¯<code>Select interface layer</code>è¿™ä¸€æ ï¼Œä¸€å®šè¦é€‰<code>C API with 32-bit integer</code>ï¼Œä¸ç„¶å¯èƒ½ä¼š<a href="https://github.com/facebookresearch/faiss/issues/2641">æŠ¥é”™</a>ï¼›å¦ä¸€ä¸ªæ˜¯<code>Select OpenMP library</code>æ ¹æ®ä½ ç”¨çš„OpenMPåº“æ¥é€‰ï¼Œå¦‚æœä½ è£…è¿‡<code>libiomp</code>å°±å¯ä»¥é€‰Intelçš„OpenMPåº“ï¼Œä¸è¿‡æˆ‘æ¯”è¾ƒè¿‡å®ƒå’ŒGNUçš„OpenMPåœ¨æˆ‘ç”¨çš„Faissç®—æ³•ä¸Šæ•ˆç‡å·®ä¸å¤šï¼Œæ‰€ä»¥ç”¨å“ªä¸ªåº”è¯¥éƒ½æ— æ‰€è°“ã€‚ç”Ÿæˆå®Œäº†ç”¨<code>Use this link line</code>é‡Œçš„å†…å®¹æ›¿æ¢ä¸Šé¢çš„ç¬¬ä¸‰è¡Œã€‚</p>
<h4 id="æŠ€å·§">æŠ€å·§</h4>
<p>è¿™é‡Œä»‹ç»ä¸‰ä¸ªæŠ€å·§ï¼Œå‰ä¸¤ä¸ªé’ˆå¯¹é¢„ç¼–è¯‘çš„Pythonåº“ï¼Œç¬¬ä¸‰ä¸ªé’ˆå¯¹C++åº“ï¼š</p>
<ol type="1">
<li><p>Pythonå¯ä»¥ä½¿ç”¨contribå­ç›®å½•ä¸‹çš„å†…å®¹ï¼Œé‡Œé¢åŒ…å«äº†ä¸€äº›å®ç”¨å‡½æ•°ï¼Œæ¯”å¦‚<code>vecs_io.py</code>é‡Œçš„å‡½æ•°å¯ä»¥å¾ˆæ–¹ä¾¿çš„è¯»å†™SIFT1M/GIST1Mæ•°æ®é›†çš„æ–‡ä»¶æ ¼å¼ï¼›<code>torch_utils.py</code>åˆ™å¯ä»¥è‡ªåŠ¨åŒ…è£…faissé‡Œçš„å¸¸è§ç´¢å¼•è®©å®ƒä»¬èƒ½ç›´æ¥æ¥å—pytorchå¼ é‡ä½œä¸ºå‚æ•°ï¼ŒGPUå¼ é‡ä¹Ÿå¯ä»¥ç›´æ¥ä¼ è¿›å»ï¼ŒèŠ‚çœäº†ä¼ åˆ°Hostç«¯çš„numpyæ•°ç»„å†ä¼ åˆ°æ˜¾å­˜çš„å¼€é”€ã€‚</p></li>
<li><p>Faisså†…æœ‰çš„å±æ€§æˆ–è€…æ–¹æ³•è¿”å›å€¼æ²¡æœ‰æä¾›PythonåŒ…è£…ï¼Œæ¯”å¦‚è¿”å›ä¸€ä¸ªvectoræˆ–è€…æŒ‡é’ˆï¼Œè¿™å°±å¯ä»¥ç”¨<code>faiss/python</code>æ–‡ä»¶ä¸‹çš„å‡ ä¸ªæ–‡ä»¶è§£å†³ï¼Œå…·ä½“è€Œè¨€ï¼Œå¯ä»¥ä½¿ç”¨<code>array_conversions.py</code>æä¾›çš„<code>vector_to_array</code>ã€<code>copy_array_to_vector</code>è¿›è¡Œè½¬æ¢ï¼›è€Œ<code>swigfaiss.swig</code>åˆ™å®šä¹‰äº†ä¸å°‘æ›´åº•å±‚çš„æ“ä½œï¼Œæ¯”å¦‚<code>swig_ptr</code>å¯ä»¥å°†numpyæ•°ç»„è½¬æ¢æˆCæŒ‡é’ˆï¼Œ<code>memcpy</code>å¯ä»¥åœ¨Pythonä»£ç é‡Œå¯¹ä¸åŒCæŒ‡é’ˆæŒ‡å‘çš„æ•°æ®è¿›è¡Œå€’è…¾ï¼Œ<code>omp_set_num_threads</code>å¯ä»¥è®¾ç½®faisså†…éƒ¨çš„çº¿ç¨‹æ•°ã€‚è¿™äº›åœ¨Pythonä»£ç é‡Œéƒ½ç”¨<code>faiss.XXX()</code>è°ƒç”¨å³å¯ã€‚</p></li>
<li><p>æœ‰æ—¶éœ€è¦ç»Ÿè®¡Faissé‡Œå›¾ç®—æ³•çš„è·ç¦»è®¡ç®—æ¬¡æ•°ï¼Œç›´æ¥æ”¹åº“çš„ä»£ç æ¯”è¾ƒéº»çƒ¦ï¼Œå¯ä»¥é€šè¿‡ç»§æ‰¿è·ç¦»è®¡ç®—ç±»å’ŒFlatç±»ï¼Œç„¶åä¼ ç»™å›¾ç®—æ³•çš„æ„é€ å‡½æ•°ï¼Œè·ç¦»è®¡ç®—æ¬¡æ•°ç”¨å…¨å±€å˜é‡æ¥å­˜å‚¨ï¼Œå…·ä½“ä»£ç å¦‚ä¸‹ï¼ˆä»¥HNSWä¸ºä¾‹ï¼‰ï¼š</p></li>
</ol>
<div class="sourceCode" id="cb3"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb3-1"><a href="#cb3-1"></a><span class="pp">#include </span><span class="im">&lt;faiss/IndexFlat.h&gt;</span></span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="pp">#include </span><span class="im">&lt;faiss/IndexHNSW.h&gt;</span></span>
<span id="cb3-3"><a href="#cb3-3"></a><span class="pp">#include </span><span class="im">&lt;faiss/utils/distances.h&gt;</span></span>
<span id="cb3-4"><a href="#cb3-4"></a></span>
<span id="cb3-5"><a href="#cb3-5"></a><span class="dt">long</span> <span class="dt">long</span> total_dist;</span>
<span id="cb3-6"><a href="#cb3-6"></a></span>
<span id="cb3-7"><a href="#cb3-7"></a><span class="co">// å’Œfaiss/IndexFlat.cppé‡Œçš„å®ç°åŸºæœ¬ä¸€è‡´ï¼Œä»…ä»…åˆ å»äº†ä¸€äº›æ²¡ç”¨åˆ°çš„ä»£ç å¹¶æ·»åŠ äº†total_distçš„ç»Ÿè®¡</span></span>
<span id="cb3-8"><a href="#cb3-8"></a><span class="kw">struct</span> FlatL2Dis : FlatCodesDistanceComputer {</span>
<span id="cb3-9"><a href="#cb3-9"></a>    <span class="dt">size_t</span> d;</span>
<span id="cb3-10"><a href="#cb3-10"></a>    <span class="dt">idx_t</span> nb;</span>
<span id="cb3-11"><a href="#cb3-11"></a>    <span class="at">const</span> <span class="dt">float</span>* q;</span>
<span id="cb3-12"><a href="#cb3-12"></a>    <span class="at">const</span> <span class="dt">float</span>* b;</span>
<span id="cb3-13"><a href="#cb3-13"></a></span>
<span id="cb3-14"><a href="#cb3-14"></a>    <span class="dt">float</span> distance_to_code(<span class="at">const</span> <span class="dt">uint8_t</span>* code) <span class="kw">final</span> {</span>
<span id="cb3-15"><a href="#cb3-15"></a>        total_dist++;</span>
<span id="cb3-16"><a href="#cb3-16"></a>        <span class="cf">return</span> fvec_L2sqr(q, (<span class="dt">float</span>*)code, d);</span>
<span id="cb3-17"><a href="#cb3-17"></a>    }</span>
<span id="cb3-18"><a href="#cb3-18"></a>    <span class="dt">float</span> symmetric_dis(<span class="dt">idx_t</span> i, <span class="dt">idx_t</span> j) <span class="kw">override</span> {</span>
<span id="cb3-19"><a href="#cb3-19"></a>        total_dist++;</span>
<span id="cb3-20"><a href="#cb3-20"></a>        <span class="cf">return</span> fvec_L2sqr(b + j * d, b + i * d, d);</span>
<span id="cb3-21"><a href="#cb3-21"></a>    }</span>
<span id="cb3-22"><a href="#cb3-22"></a>    <span class="kw">explicit</span> FlatL2Dis(<span class="at">const</span> IndexFlat&amp; storage, <span class="at">const</span> <span class="dt">float</span>* q = <span class="kw">nullptr</span>):</span>
<span id="cb3-23"><a href="#cb3-23"></a>        FlatCodesDistanceComputer(storage.codes.data(), storage.code_size),</span>
<span id="cb3-24"><a href="#cb3-24"></a>        d(storage.d), nb(storage.ntotal), q(q), b(storage.get_xb()) {}</span>
<span id="cb3-25"><a href="#cb3-25"></a>    <span class="dt">void</span> set_query(<span class="at">const</span> <span class="dt">float</span>* x) <span class="kw">override</span> {</span>
<span id="cb3-26"><a href="#cb3-26"></a>        q = x;</span>
<span id="cb3-27"><a href="#cb3-27"></a>    }</span>
<span id="cb3-28"><a href="#cb3-28"></a>};</span>
<span id="cb3-29"><a href="#cb3-29"></a></span>
<span id="cb3-30"><a href="#cb3-30"></a><span class="co">// å› ä¸ºIndexFlatå®šä¹‰åœ¨faiss/IndexFlat.hå¤´æ–‡ä»¶é‡Œï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥ç»§æ‰¿IndexFlatï¼Œåªé‡è½½get_FlatCodesDistanceComputer</span></span>
<span id="cb3-31"><a href="#cb3-31"></a><span class="kw">struct</span> IndexFlatMy: IndexFlat {</span>
<span id="cb3-32"><a href="#cb3-32"></a>    <span class="kw">explicit</span> IndexFlatMy(<span class="dt">idx_t</span> d): IndexFlat(d, METRIC_L2) {}</span>
<span id="cb3-33"><a href="#cb3-33"></a>    IndexFlatMy() {}</span>
<span id="cb3-34"><a href="#cb3-34"></a>    FlatCodesDistanceComputer* get_FlatCodesDistanceComputer() <span class="at">const</span> <span class="kw">override</span> {</span>
<span id="cb3-35"><a href="#cb3-35"></a>        <span class="cf">return</span> <span class="kw">new</span> FlatL2Dis(*<span class="kw">this</span>);</span>
<span id="cb3-36"><a href="#cb3-36"></a>    }</span>
<span id="cb3-37"><a href="#cb3-37"></a>};</span>
<span id="cb3-38"><a href="#cb3-38"></a></span>
<span id="cb3-39"><a href="#cb3-39"></a><span class="co">// ...</span></span>
<span id="cb3-40"><a href="#cb3-40"></a></span>
<span id="cb3-41"><a href="#cb3-41"></a>IndexFlatMy indexflatmy(d);</span>
<span id="cb3-42"><a href="#cb3-42"></a>IndexHNSW index(&amp;indexflatmy, <span class="dv">32</span>);</span>
<span id="cb3-43"><a href="#cb3-43"></a></span>
<span id="cb3-44"><a href="#cb3-44"></a>total_dist = <span class="dv">0</span>;</span>
<span id="cb3-45"><a href="#cb3-45"></a>index.add(myn, traindata.data());</span>
<span id="cb3-46"><a href="#cb3-46"></a>printf(<span class="st">&quot;</span><span class="sc">%lld\n</span><span class="st">&quot;</span>, total_dist);</span></code></pre></div>
<h3 id="raft">Raft</h3>
<p>Raftè¿™ä¸ªåº“ï¼Œä¸»è¦æ˜¯ä¸ºäº†ä½¿ç”¨å…¶ä¸­GNNDå’ŒCAGRAç®—æ³•ï¼Œå‘å¤šå¾—ä¸å¯ç†å–»ï¼Œæˆ‘å°è¯•äº†å¥½å‡ æ¬¡æ‰æœ€ç»ˆæˆåŠŸã€‚</p>
<h4 id="ç¼–è¯‘-1">ç¼–è¯‘</h4>
<p>ç¼–è¯‘å°±æ˜¯ä¸€ä¸ªå¤§å‘ï¼Œå› ä¸ºç›´æ¥æŒ‰æ–‡æ¡£é‡Œçš„æŒ‡ç¤ºæ˜¯ç¼–è¯‘ä¸å‡ºæ¥çš„ğŸ˜…ã€‚æŒ‰ç…§æ–‡æ¡£çš„æŒ‡ç¤ºï¼ŒRaftåº“æœ‰ä¸‰ç§ç”¨æ³•ï¼š</p>
<ul>
<li>ç¬¬ä¸€ç§æ˜¯Pythoné¢„ç¼–è¯‘åº“ï¼Œè¿™ä¸ªæ²¡å•¥é—®é¢˜ï¼Œä½†ç”¨ä¸äº†GNNDç®—æ³•ï¼ŒCAGRAç®—æ³•ä¹Ÿå¿…é¡»æ•´ä½“ä½¿ç”¨ï¼Œæ— æ³•åˆ†åˆ«ç»Ÿè®¡ä¸¤é˜¶æ®µçš„æ—¶é—´ï¼Œä¹Ÿæ— æ³•è°ƒæ•´æ›´ç»†è‡´çš„å‚æ•°ï¼›</li>
<li>ç¬¬äºŒç§æ˜¯C++é¢„ç¼–è¯‘åº“ï¼Œé€šè¿‡Condaå®‰è£…ï¼Œç„¶åå»include Raftçš„Runtime APIï¼ˆ<code>cpp/include/raft_runtime</code>ä¸‹é‚£äº›ï¼‰ï¼Œä½†é—®é¢˜æ˜¯è¿™äº›Runtime APIä¹Ÿè¦å¼•ç”¨Raftæœ¬ä½“APIå•Šï¼Œæ‰€ä»¥æˆ‘æ˜¯ç†è§£ä¸äº†è¿™ä¸€ç§æ–¹æ¡ˆç›¸æ¯”ç¬¬ä¸‰ç§æ–¹æ¡ˆåˆ°åº•æœ‰ä»€ä¹ˆæ„ä¹‰ï¼›</li>
<li>ç¬¬ä¸‰ç§å°±æ˜¯ç›´æ¥å¼•ç”¨æºç ï¼Œç”±äºè¿™ä¸ªåº“æ˜¯header-only template libraryï¼Œæ‰€ä»¥ç†è®ºä¸Šç›´æ¥åœ¨ä»£ç é‡Œincludeæƒ³è¦çš„å¤´æ–‡ä»¶ç„¶åæƒ³åŠæ³•ç¼–è¯‘æˆåŠŸå°±è¡Œäº†ã€‚æˆ‘å°±æ˜¯è¿™æ ·æƒ³çš„ï¼Œç„¶åå°±æ‰è¿›é‡é‡æ·±å‘é‡Œæ‘”å¾—ç‹—è¡€ä¸´å¤´ã€‚å…³é”®åœ¨äºè¿™ä¸ªåº“ä¾èµ–éå¸¸å¤šRapidså®¶æ—å…¶ä»–çš„åº“ï¼Œè€Œè¿™äº›åº“åˆæ²¡æœ‰ä¸ŠAPTæºï¼Œå› æ­¤å¾ˆéš¾è§£å†³ç›˜æ ¹é”™ç»“çš„ä¾èµ–å…³ç³»ä»¥åŠå„ç§ç¯å¢ƒå˜é‡ã€è·¯å¾„çš„è®¾ç½®ï¼Œç„¶åå®ƒè¿˜ç”¨çš„æ˜¯è‡ªå·±çš„CMakeæ’ä»¶ï¼Œä¸‹è½½äº†å•¥æ›´æ˜¯ä¸€å›¢æµ†ç³Šã€‚åœ¨ç»å†äº†Spdlogç‰ˆæœ¬ä¸å¯¹ï¼Œæœªå¼•ç”¨libcudacxxç­‰é”™è¯¯ä¹‹åï¼Œç¼–è¯‘å™¨æœ€ç»ˆæ­»åœ¨äº†å±‚å±‚å å ä¸çŸ¥é“æ˜¯C++æ ‡å‡†è¿˜æ˜¯NVCCå…¼å®¹æ€§å¯¼è‡´çš„ä¸€å †è¯­æ³•é”™è¯¯ä¸­ğŸ¤ªã€‚</li>
</ul>
<p>æ­£ç¡®æ–¹æ³•è—åœ¨<a href="https://github.com/rapidsai/raft/tree/branch-24.04/cpp/template">è¿™é‡Œ</a>ã€‚å…·ä½“æ“ä½œæ­¥éª¤å¦‚ä¸‹ï¼š</p>
<ol type="1">
<li>å¼ºçƒˆå»ºè®®ç§‘å­¦ä¸Šç½‘ï¼Œå› ä¸ºå®ƒä¼šç”¨CMakeæ’ä»¶è‡ªåŠ¨ä»GithubæŠ“å–ä¾èµ–åº“ï¼ŒGithubä»¥åŠå®ƒçš„å­åŸŸåèƒ½å¦è®¿é—®æ˜¯ä¸ªç„å­¦ï¼Œè‡³å°‘æˆ‘è¿™é‡Œä¸ç§‘å­¦ä¸Šç½‘æ€»ä¼šå¡åœ¨æŸä¸ªåœ°æ–¹ï¼Œæ‰‹åŠ¨æ”¹æˆé•œåƒç½‘å€ä¹Ÿä¸ç°å®ï¼Œè‡³å°‘æˆ‘æ˜¯çœ‹ä¸æ‡‚å®ƒä¹±ä¸ƒå…«ç³Ÿçš„é…ç½®è·¯å¾„ï¼Œè€Œä¸”æ¯æ¬¡ç¼–è¯‘çš„æ—¶å€™éƒ½è¦ä¿æŒè”ç½‘å¹¶ä¸”ç§‘å­¦ä¸Šç½‘çŠ¶æ€ï¼ˆæŒºç¦»è°±çš„ï¼‰ã€‚</li>
<li>æŠŠæ•´ä¸ªé¡¹ç›®å…‹éš†ä¸‹æ¥ï¼Œç„¶åå°†<code>cpp/template</code>è¿™ä¸ªæ–‡ä»¶å¤¹å•ç‹¬å¤åˆ¶å‡ºæ¥ï¼Œä¹‹åçš„æ“ä½œéƒ½åœ¨è¿™ä¸ªæ–‡ä»¶å¤¹ä¸‹æ“ä½œï¼Œæ‰€ä»¥å…‹éš†çš„é¡¹ç›®å¯ä»¥åˆ æ‰äº†ã€‚</li>
<li>æŒ‰ç…§ä½ çš„éœ€è¦ä¿®æ”¹srcæ–‡ä»¶å¤¹ä¸‹çš„ä»£ç ï¼Œä¿®æ”¹<code>CMakeLists.txt</code>ä»¥æ·»åŠ é“¾æ¥åº“ã€å¢åˆ è¦ç¼–è¯‘çš„æºæ–‡ä»¶ï¼Œç„¶å<code>./build.sh</code>å°±å¯ä»¥ç¼–è¯‘äº†ï¼Œç¼–è¯‘æ—¶é—´æ¯”è¾ƒé•¿ï¼Œå› ä¸ºéœ€è¦æŠ“å–ä¾èµ–åº“ã€‚ç¼–è¯‘åçš„ç¨‹åºåœ¨<code>build</code>æ–‡ä»¶å¤¹ä¸‹ã€‚</li>
</ol>
<h4 id="è¿è¡Œ">è¿è¡Œ</h4>
<p>è¿è¡Œä¹Ÿæ˜¯ä¸€ä¸ªå¤§å‘ï¼Œè¿™é‡Œç›´æ¥ç»™å‡ºæˆ‘æ‰§è¡ŒCAGRAä¸¤é˜¶æ®µçš„ä»£ç ï¼š</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb4-1"><a href="#cb4-1"></a><span class="pp">#include </span><span class="im">&lt;vector&gt;</span></span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="pp">#include </span><span class="im">&lt;raft/core/copy.cuh&gt;</span></span>
<span id="cb4-3"><a href="#cb4-3"></a><span class="pp">#include </span><span class="im">&lt;raft/core/mdspan.hpp&gt;</span></span>
<span id="cb4-4"><a href="#cb4-4"></a><span class="pp">#include </span><span class="im">&lt;raft/neighbors/cagra.cuh&gt;</span></span>
<span id="cb4-5"><a href="#cb4-5"></a></span>
<span id="cb4-6"><a href="#cb4-6"></a><span class="kw">using</span> <span class="kw">namespace</span> raft::neighbors;</span>
<span id="cb4-7"><a href="#cb4-7"></a></span>
<span id="cb4-8"><a href="#cb4-8"></a><span class="co">// è¯»å–SIFT1Mæ•°æ®æ–‡ä»¶çš„å‡½æ•°</span></span>
<span id="cb4-9"><a href="#cb4-9"></a><span class="kw">template</span>&lt;<span class="kw">typename</span> T&gt; <span class="dt">int</span> vecs_read(<span class="at">const</span> <span class="bu">std::</span>string &amp;filename, <span class="bu">std::</span>vector&lt;T&gt; &amp;out, <span class="dt">long</span> <span class="dt">long</span> cnt) {</span>
<span id="cb4-10"><a href="#cb4-10"></a>    <span class="bu">std::</span>ifstream f(filename, <span class="bu">std::</span>ios<span class="bu">::</span>binary); <span class="cf">if</span> (!f) <span class="cf">return</span> -<span class="dv">1</span>;</span>
<span id="cb4-11"><a href="#cb4-11"></a>    <span class="dt">int</span> dim; f.read((<span class="dt">char</span> *)&amp;dim, <span class="dv">4</span>); out.resize(cnt * dim); f.seekg(<span class="dv">0</span>, <span class="bu">std::</span>ios<span class="bu">::</span>beg);</span>
<span id="cb4-12"><a href="#cb4-12"></a>    <span class="cf">for</span> (<span class="dt">long</span> <span class="dt">long</span> i = <span class="dv">0</span>; i &lt; cnt; i++) {</span>
<span id="cb4-13"><a href="#cb4-13"></a>        f.seekg(<span class="dv">4</span>, <span class="bu">std::</span>ios<span class="bu">::</span>cur); f.read((<span class="dt">char</span> *)(out.data() + i * dim), dim * <span class="kw">sizeof</span>(T));</span>
<span id="cb4-14"><a href="#cb4-14"></a>    }</span>
<span id="cb4-15"><a href="#cb4-15"></a>    <span class="cf">return</span> dim;</span>
<span id="cb4-16"><a href="#cb4-16"></a>}</span>
<span id="cb4-17"><a href="#cb4-17"></a></span>
<span id="cb4-18"><a href="#cb4-18"></a><span class="dt">int</span> main(<span class="dt">int</span> argc, <span class="dt">char</span>** argv) {</span>
<span id="cb4-19"><a href="#cb4-19"></a></span>
<span id="cb4-20"><a href="#cb4-20"></a>    <span class="dt">int</span> myn = <span class="dv">1000000</span>;</span>
<span id="cb4-21"><a href="#cb4-21"></a>    <span class="bu">std::</span>vector&lt;<span class="dt">float</span>&gt; traindata;</span>
<span id="cb4-22"><a href="#cb4-22"></a>    <span class="dt">int</span> d = vecs_read(argv[<span class="dv">1</span>], traindata, myn); printf(<span class="st">&quot;</span><span class="sc">%d\n</span><span class="st">&quot;</span>, d);</span>
<span id="cb4-23"><a href="#cb4-23"></a>    raft::device_resources dev_resources;</span>
<span id="cb4-24"><a href="#cb4-24"></a></span>
<span id="cb4-25"><a href="#cb4-25"></a>    <span class="co">// å®šä¹‰hostçŸ©é˜µï¼Œç„¶åå°†è¯»å–çš„å‘é‡æ•°æ®åº“ä¼ è¿‡å»ï¼Œå†å®šä¹‰deviceçŸ©é˜µï¼Œæœ€åå°†hostçŸ©é˜µçš„å†…å®¹å¤åˆ¶åˆ°deviceçŸ©é˜µ</span></span>
<span id="cb4-26"><a href="#cb4-26"></a>    <span class="kw">auto</span> host_dataset = raft::make_host_matrix&lt;<span class="dt">float</span>, <span class="dt">int64_t</span>&gt;(dev_resources, myn, d);</span>
<span id="cb4-27"><a href="#cb4-27"></a>    <span class="cf">for</span> (<span class="dt">int</span> i = <span class="dv">0</span>; i &lt; myn; i++)</span>
<span id="cb4-28"><a href="#cb4-28"></a>        <span class="cf">for</span> (<span class="dt">int</span> j = <span class="dv">0</span>; j &lt; d; j++)</span>
<span id="cb4-29"><a href="#cb4-29"></a>            host_dataset(i, j) = traindata[i * d + j];</span>
<span id="cb4-30"><a href="#cb4-30"></a>    <span class="kw">auto</span> dataset = raft::make_device_matrix&lt;<span class="dt">float</span>, <span class="dt">int64_t</span>&gt;(dev_resources, myn, d);</span>
<span id="cb4-31"><a href="#cb4-31"></a>    raft::copy(dev_resources, dataset.view(), host_dataset.view());</span>
<span id="cb4-32"><a href="#cb4-32"></a></span>
<span id="cb4-33"><a href="#cb4-33"></a>    <span class="co">// æˆ‘ç”¨çš„æ˜¯ä½¿ç”¨GNNDæ„å»ºCAGRAä¸€é˜¶æ®µKNNå›¾çš„æ–¹å¼</span></span>
<span id="cb4-34"><a href="#cb4-34"></a>    experimental::nn_descent::index_params build_params;</span>
<span id="cb4-35"><a href="#cb4-35"></a>    build_params.graph_degree = <span class="dv">64</span>;</span>
<span id="cb4-36"><a href="#cb4-36"></a>    <span class="kw">auto</span> knn_graph = raft::make_host_matrix&lt;<span class="dt">int64_t</span>, <span class="dt">int64_t</span>&gt;(myn, <span class="dv">64</span>);</span>
<span id="cb4-37"><a href="#cb4-37"></a>    cagra::build_knn_graph(dev_resources, raft::make_const_mdspan(dataset.view()), knn_graph.view(), build_params);</span>
<span id="cb4-38"><a href="#cb4-38"></a></span>
<span id="cb4-39"><a href="#cb4-39"></a>    <span class="co">// äºŒé˜¶æ®µä¼˜åŒ–</span></span>
<span id="cb4-40"><a href="#cb4-40"></a>    <span class="kw">auto</span> optimized_graph = raft::make_host_matrix&lt;<span class="dt">int64_t</span>, <span class="dt">int64_t</span>&gt;(myn, <span class="dv">32</span>);</span>
<span id="cb4-41"><a href="#cb4-41"></a>    cagra::optimize(dev_resources, knn_graph.view(), optimized_graph.view());</span>
<span id="cb4-42"><a href="#cb4-42"></a></span>
<span id="cb4-43"><a href="#cb4-43"></a>    <span class="cf">return</span> <span class="dv">0</span>;</span>
<span id="cb4-44"><a href="#cb4-44"></a>}</span></code></pre></div>
<p>æœ‰ä¸¤ä¸ªå‘ç‚¹ï¼Œç¬¬ä¸€ä¸ªæ˜¯å¦‚ä½•å°†è¯»å–çš„å‘é‡æ•°æ®åº“ä¼ åˆ°è®¾å¤‡ä¸­ï¼Œæˆ‘æŸ¥äº†åŒå¤§çš„æ–‡æ¡£å±…ç„¶æ²¡ä¸€å¤„æåˆ°ã€‚demoå†è¿™ä¹ˆè¯´ä¹Ÿå¾—ç”¨ä¸€ä¸ªæ¯”è¾ƒå®é™…çš„å‘é‡æ•°æ®åº“ä½œç¤ºä¾‹å§ï¼Œç«Ÿç„¶ç”¨éšæœºç”Ÿæˆçš„æ•°æ®åº“ã€‚è¿™ä¸ªåº“è¿˜ä¸“é—¨ä¸ºéšæœºç”Ÿæˆå‘é‡æ•°æ®åº“æä¾›äº†ä¸€å¥—APIï¼Œè€Œæ²¡æœ‰æä¾›å’Œvectorè¿˜æ˜¯ä¼ ç»Ÿæ•°ç»„äº¤äº’çš„APIï¼ŒçœŸçš„æ˜¯æ— è¯­ğŸ˜…ğŸ˜…ğŸ˜…â€¦â€¦è™½ç„¶ä¹Ÿæœ‰å¯èƒ½æ˜¯æˆ‘æ‰ç–å­¦æµ…æ²¡æ‰¾åˆ°APIï¼Œä½†å°±åƒæˆ‘è¯´çš„ï¼Œè¦æ˜¯çœŸæœ‰è¿™ç§APIï¼Œæ­£å¸¸å°±åº”è¯¥åœ¨æœ€æ˜æ˜¾çš„åœ°æ–¹ï¼ˆæ¯”å¦‚READMEï¼‰ç»™ä¸ªç¤ºä¾‹ï¼Œæœ€å¥½æ˜¯ç”¨SIFT1Mè¿™ç§å¸¸ç”¨çš„benchmarkï¼Œç„¶åæŠŠè¯»å–ã€è®­ç»ƒã€æŸ¥è¯¢æ˜æ˜ç™½ç™½çš„å±•ç¤ºå‡ºæ¥ã€‚æœ€åæ²¡åŠæ³•ï¼Œä»¿ç…§<a href="https://docs.rapids.ai/api/raft/stable/vector_search_tutorial/">è¿™ä¸ª</a>å†™äº†ä¸ªæš´åŠ›å¤åˆ¶ã€‚ä¸ªäººçŒœæµ‹<code>host_matrix</code>å’Œ<code>device_matrix</code>åº”è¯¥æ˜¯æœ‰APIèƒ½å¤Ÿæš´éœ²æŒ‡é’ˆçš„ï¼Œç„¶åé€šè¿‡memcpyæˆ–è€…cudaMemcpyå€’è…¾æ•°æ®ï¼Œå› ä¸ºPythonåº“å¯ä»¥ç›´æ¥ç”¨pytorchæˆ–è€…cupyçš„å¼ é‡ä½œæ¥å£ï¼Œä½†æˆ‘ç¡®å®æ˜¯æ²¡åœ¨C++è¿™è¾¹æ‰¾åˆ°ã€‚ï¼ˆæ›´æ–°ï¼šçœ‹äº†åº“é‡Œå‡ ä¸ªç®—æ³•çš„å®ç°ï¼Œè¿™ä¸ªæ–¹æ³•åº”è¯¥æ˜¯<code>.data_handle()</code>ï¼Œè¿”å›æ•°æ®æ¨¡æ¿ç±»å‹çš„æŒ‡é’ˆï¼Œä½†æˆ‘è¿˜æ²¡æœ‰æµ‹è¯•ï¼‰</p>
<p>ç¬¬äºŒä¸ªå‘ç‚¹æ˜¯<code>cagra::build_knn_graph</code>å’Œ<code>cagra::optimize</code>çš„æ¨¡æ¿ç±»å‹éœ€æ±‚ï¼Œç¨æœ‰ä¸æ…ç¼–è¯‘å°±è¿‡ä¸äº†ï¼Œé€šè¿‡<code>cpp/include/raft/neighbors/detail/cagra/cagra_build.cuh</code>å¯ä»¥çœ‹åˆ°ä¸¤ä¸ªå‡½æ•°åˆ†åˆ«é™åˆ¶äº†<code>knn_graph</code>å’Œ<code>optimized_graph</code>çš„ç¬¬äºŒä¸ªæ¨¡æ¿å‚æ•°å¿…é¡»æ˜¯<code>int64_t</code>ï¼ŒåŒæ—¶é™åˆ¶äº†å®ƒä»¬çš„ç¬¬ä¸€ä¸ªæ¨¡æ¿å‚æ•°å¿…é¡»ä¸€è‡´ã€‚</p>
<h3 id="æ€»ç»“">æ€»ç»“</h3>
<p>ä»¥Faissä¸ºä»£è¡¨çš„å¤§éƒ¨åˆ†åº“ç¼–è¯‘è¿è¡ŒåŸºæœ¬éƒ½æ²¡å¤ªå¤§é—®é¢˜ï¼Œ<code>cmake ..</code>ï¼Œç¼ºå•¥è¡¥å•¥ï¼Œç„¶å<code>make -j</code>ï¼Œä½¿ç”¨æ—¶<code>-I</code>ã€<code>-L</code>ã€<code>-l</code>æŒ‡å®šå¥½è·¯å¾„å’Œé“¾æ¥åº“å°±å®Œäº‹äº†ï¼›éº»çƒ¦çš„è¿˜æ˜¯æƒ³Raftè¿™ç§çš„ï¼Œé›†é½äº†header-onlyã€cudaã€cmakeæ’ä»¶ç­‰è¯¸å¤šå‘ç‚¹ï¼ŒåŠ ä¸Šæ–‡æ¡£å†™çš„å¤ªåƒåœ¾ï¼Œæ‰ä¼šè¿™ä¹ˆæ¶å¿ƒã€‚é‡åˆ°è¿™ç§éº»çƒ¦åº“ï¼Œç»æ‹›å°±æ˜¯å»æ‰¾å®ƒç›®å½•ä¸‹çš„testingã€demoã€templateè¿™ç§æ–‡ä»¶å¤¹æˆ–è€…åŒå¼€å‘è€…ä»¥è¿™äº›åå­—å‘½åçš„ä»“åº“ï¼Œä¸€èˆ¬è¿™ç§åœ°æ–¹æä¾›çš„cmakelists/makefileæ€»æ˜¯å¯ç”¨çš„ã€‚</p>
<footer>
    <hr>
    <center>
        Powered by <a href="https://github.com/ZimingYuan/Yblogs" target="_blank">Yblogs</a><br>
        è½¬è½½è¯·æ³¨æ˜å‡ºå¤„<br>
        Â© 2026 VnYzmçš„åšå®¢<br>
    </center>
</footer>
</body>
</html>
